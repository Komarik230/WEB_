(function(g,h,r){function n(){var a=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var b=0;b<a.length;b++)if(a[b]+"Hidden"in document)return a[b]+"Hidden";return null}var p=g.event,l,m;l=p.special.debouncedresize={setup:function(){g(this).on("resize",l.handler)},teardown:function(){g(this).off("resize",l.handler)},handler:function(a,b){var e=this,d=arguments,f=function(){a.type="debouncedresize";p.dispatch.apply(e,d)};m&&clearTimeout(m);b?f():m=setTimeout(f,l.threshold)},threshold:100};
Array.prototype.shuffle=function(){for(var a=this.length,b,e;a--;)b=Math.floor(Math.random()*a),e=this[a],this[a]=this[b],this[b]=e;return this};var t=g(h),k=h.Modernizr;g.GridRotator=function(a,b){this.$el=g(b);k.backgroundsize&&(this.$el.addClass("ri-grid-loading"),this._init(a))};g.GridRotator.defaults={rows:4,columns:10,imageRatio:1,w1024:{rows:3,columns:8},w768:{rows:3,columns:7},w480:{rows:3,columns:5},w320:{rows:2,columns:4},w240:{rows:2,columns:3},step:"random",maxStep:3,preventClick:!0,animType:"random",
animSpeed:800,animEasingOut:"linear",animEasingIn:"linear",interval:3E3,slideshow:!0,onhover:!1,nochange:[]};g.GridRotator.prototype={_init:function(a){this.options=g.extend(!0,{},g.GridRotator.defaults,a);this._config()},_config:function(){var a=this;this.supportTransitions=k.csstransitions;this.supportTransforms3D=k.csstransforms3d;this.transEndEventName={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[k.prefixed("transition")]+
".gridrotator";this.animTypes=this.supportTransforms3D?"fadeInOut slideLeft slideRight slideTop slideBottom rotateLeft rotateRight rotateTop rotateBottom scale rotate3d rotateLeftScale rotateRightScale rotateTopScale rotateBottomScale".split(" "):["fadeInOut","slideLeft","slideRight","slideTop","slideBottom"];this.animType=this.options.animType;"random"===this.animType||this.supportTransforms3D||-1!==g.inArray(this.animType,this.animTypes)||"showHide"===this.animType||(this.animType="fadeInOut");
this.animTypesTotal=this.animTypes.length;this.$list=this.$el.children("ul");var b=0,e=this.$list.find("img"),d=e.length;e.each(function(){var f=g(this),c=f.attr("src");g("<img/>").load(function(){++b;f.parent().css("background-image","url("+c+")");b===d&&(e.remove(),a.$el.removeClass("ri-grid-loading"),a.$items=a.$list.children("li"),a.$itemsCache=a.$items.clone(),a.itemsTotal=a.$items.length,a.outItems=[],a._layout(function(){a._initEvents()}),a._start())}).attr("src",c)})},_layout:function(a){var b=
this;this._setGridDim();this.$list.empty();this.$items=this.$itemsCache.clone().appendTo(this.$list);var e=this.$items.filter(":gt("+(this.showTotal-1)+")"),d=e.children("a");this.outItems.length=0;d.each(function(a){b.outItems.push(g(this))});e.remove();for(var d=document.defaultView?parseInt(document.defaultView.getComputedStyle(this.$el.get(0),null).width):this.$el.width(),e=Math.floor(d/this.columns),d=d-this.columns*Math.floor(e),f=0;f<this.rows;++f)for(var c=0;c<this.columns;++c){var q=this.columns*
f+c,h=this.$items.eq(q);h.css({width:c<Math.floor(d)?e+1:e,height:e/this.options.imageRatio});-1!==g.inArray(q,this.options.nochange)&&h.addClass("ri-nochange").data("nochange",!0)}if(this.options.preventClick)this.$items.children().css("cursor","default").on("click.gridrotator",!1);a&&a.call()},_setGridDim:function(){var a=this.$el.width();switch(!0){case 240>a:this.rows=this.options.w240.rows;this.columns=this.options.w240.columns;break;case 320>a:this.rows=this.options.w320.rows;this.columns=this.options.w320.columns;
break;case 480>a:this.rows=this.options.w480.rows;this.columns=this.options.w480.columns;break;case 768>a:this.rows=this.options.w768.rows;this.columns=this.options.w768.columns;break;case 1024>a:this.rows=this.options.w1024.rows;this.columns=this.options.w1024.columns;break;default:this.rows=this.options.rows,this.columns=this.options.columns}this.showTotal=this.rows*this.columns},_initEvents:function(){var a=this;t.on("debouncedresize.gridrotator",function(){a._layout()});var b=n();b&&(b=b.replace(/[H|h]idden/,
"")+"visibilitychange",document.addEventListener(b,function(){a._visChange()}));if(!k.touch&&this.options.onhover)a.$items.on("mouseenter.gridrotator",function(){var b=g(this);b.data("active")||b.data("hovered")||b.data("nochange")||(b.data("hovered",!0),a._replace(b))}).on("mouseleave.gridrotator",function(){g(this).data("hovered",!1)})},_visChange:function(){var a;a=(a=n())?document[a]:!1;a?clearTimeout(this.playtimeout):this._start()},_start:function(){this.showTotal<this.itemsTotal&&this.options.slideshow&&
this._showNext()},_getAnimType:function(){return"random"===this.animType?this.animTypes[Math.floor(Math.random()*this.animTypesTotal)]:this.animType},_getAnimProperties:function(a){var b={},e={},d={},f={},c,g=0;switch(this._getAnimType()){case "showHide":c=0;f.opacity=0;break;case "fadeInOut":f.opacity=0;break;case "slideLeft":b.left=a.width();d.left=0;f.left=-a.width();break;case "slideRight":b.left=-a.width();d.left=0;f.left=a.width();break;case "slideTop":b.top=a.height();d.top=0;f.top=-a.height();
break;case "slideBottom":b.top=-a.height();d.top=0;f.top=a.height();break;case "rotateLeft":c=this.options.animSpeed/2;b.transform="rotateY(90deg)";d.transform="rotateY(0deg)";g=c;f.transform="rotateY(-90deg)";break;case "rotateRight":c=this.options.animSpeed/2;b.transform="rotateY(-90deg)";d.transform="rotateY(0deg)";g=c;f.transform="rotateY(90deg)";break;case "rotateTop":c=this.options.animSpeed/2;b.transform="rotateX(90deg)";d.transform="rotateX(0deg)";g=c;f.transform="rotateX(-90deg)";break;case "rotateBottom":c=
this.options.animSpeed/2;b.transform="rotateX(-90deg)";d.transform="rotateX(0deg)";g=c;f.transform="rotateX(90deg)";break;case "scale":c=this.options.animSpeed/2;b.transform="scale(0)";e.transform="scale(1)";d.transform="scale(1)";g=c;f.transform="scale(0)";break;case "rotateLeftScale":e.transform="scale(1)";c=this.options.animSpeed/2;b.transform="scale(0.3) rotateY(90deg)";d.transform="scale(1) rotateY(0deg)";g=c;f.transform="scale(0.3) rotateY(-90deg)";break;case "rotateRightScale":e.transform=
"scale(1)";c=this.options.animSpeed/2;b.transform="scale(0.3) rotateY(-90deg)";d.transform="scale(1) rotateY(0deg)";g=c;f.transform="scale(0.3) rotateY(90deg)";break;case "rotateTopScale":e.transform="scale(1)";c=this.options.animSpeed/2;b.transform="scale(0.3) rotateX(90deg)";d.transform="scale(1) rotateX(0deg)";g=c;f.transform="scale(0.3) rotateX(-90deg)";break;case "rotateBottomScale":e.transform="scale(1)";c=this.options.animSpeed/2;b.transform="scale(0.3) rotateX(-90deg)";d.transform="scale(1) rotateX(0deg)";
g=c;f.transform="scale(0.3) rotateX(90deg)";break;case "rotate3d":c=this.options.animSpeed/2,b.transform="rotate3d( 1, 1, 0, 90deg )",d.transform="rotate3d( 1, 1, 0, 0deg )",g=c,f.transform="rotate3d( 1, 1, 0, -90deg )"}return{startInProp:b,startOutProp:e,endInProp:d,endOutProp:f,delay:g,animSpeed:c!=r?c:this.options.animSpeed}},_showNext:function(a){var b=this;clearTimeout(this.playtimeout);this.playtimeout=setTimeout(function(){var a=b.options.step,d=b.options.maxStep;d>b.showTotal&&(d=b.showTotal);
for(var a="random"===a?Math.floor(Math.random()*d+1):Math.min(Math.abs(a),d),d=b._getRandom(a,b.showTotal),f=0;f<a;++f){var c=b.$items.eq(d[f]);if(c.data("active")||c.data("nochange"))return b._showNext(1),!1;b._replace(c)}b._showNext()},a||Math.max(Math.abs(this.options.interval),300))},_replace:function(a){a.data("active",!0);var b=this,e=a.children("a:last"),d={width:e.width(),height:e.height()};a.data("active",!0);var f=this.outItems.shift();this.outItems.push(e.clone().css("transition","none"));
f.css(d).prependTo(a);var c=this._getAnimProperties(e);f.css(c.startInProp);e.css(c.startOutProp);this._setTransition(f,"all",c.animSpeed,c.delay,this.options.animEasingIn);this._setTransition(e,"all",c.animSpeed,0,this.options.animEasingOut);this._applyTransition(f,c.endInProp,c.animSpeed,function(){var a=g(this),d=c.animSpeed===b.options.animSpeed&&0===Object.keys(c.endInProp).length?c.animSpeed:0;setTimeout(function(){b.supportTransitions&&a.off(b.transEndEventName);a.next().remove();a.parent().data("active",
!1)},d)},0===c.animSpeed||0===Object.keys(c.endInProp).length);this._applyTransition(e,c.endOutProp,c.animSpeed)},_getRandom:function(a,b){for(var e=[],d=0;d<b;++d)e.push(d);return e.shuffle().slice(0,a)},_setTransition:function(a,b,e,d,f){setTimeout(function(){a.css("transition",b+" "+e+"ms "+d+"ms "+f)},25)},_applyTransition:function(a,b,e,d,f){var c=this;setTimeout(function(){g.fn.applyStyle=c.supportTransitions?g.fn.css:g.fn.animate;d&&c.supportTransitions&&(a.on(c.transEndEventName,d),f&&d.call(a));
d=d||function(){return!1};a.stop().applyStyle(b,g.extend(!0,[],{duration:e+"ms",complete:d}))},25)}};g.fn.gridrotator=function(a){var b=g.data(this,"gridrotator");if("string"===typeof a){var e=Array.prototype.slice.call(arguments,1);this.each(function(){b?g.isFunction(b[a])&&"_"!==a.charAt(0)?b[a].apply(b,e):h.console&&h.console.error("no such method '"+a+"' for gridrotator instance"):h.console&&h.console.error("cannot call methods on gridrotator prior to initialization; attempted to call method '"+
a+"'")})}else this.each(function(){b?b._init():b=g.data(this,"gridrotator",new g.GridRotator(a,this))});return b}})(jQuery,window);